2025-02-06 10:54:08,301 - ERROR - Pipeline failed: 'Timer' object has no attribute 'measure'
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 70, in main
    with timer.measure("Total Pipeline"):
         ^^^^^^^^^^^^^
AttributeError: 'Timer' object has no attribute 'measure'
2025-02-06 10:54:51,947 - INFO - Loading data from data\k11-52548_subvolume
2025-02-06 10:54:51,949 - INFO - Completed Data Loading in 0.00s
2025-02-06 10:54:51,950 - ERROR - Pipeline failed: Error loading TIFF stack: No TIFF files found in data\k11-52548_subvolume
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\io\loader.py", line 126, in load_tiff_stack
    raise ValueError(f"No TIFF files found in {path}")
ValueError: No TIFF files found in data\k11-52548_subvolume

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 75, in main
    data = load_tiff_stack(config.input_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\io\loader.py", line 158, in load_tiff_stack
    raise ValueError(f"Error loading TIFF stack: {str(e)}")
ValueError: Error loading TIFF stack: No TIFF files found in data\k11-52548_subvolume
2025-02-06 10:55:37,986 - INFO - Loading data from data\k11-52548_subvolume
2025-02-06 10:55:37,987 - INFO - Completed Data Loading in 0.00s
2025-02-06 10:55:37,987 - ERROR - Pipeline failed: Error loading TIFF stack: No TIFF files found in data\k11-52548_subvolume
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\io\loader.py", line 126, in load_tiff_stack
    raise ValueError(f"No TIFF files found in {path}")
ValueError: No TIFF files found in data\k11-52548_subvolume

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 75, in main
    data = load_tiff_stack(config.input_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\io\loader.py", line 158, in load_tiff_stack
    raise ValueError(f"Error loading TIFF stack: {str(e)}")
ValueError: Error loading TIFF stack: No TIFF files found in data\k11-52548_subvolume
2025-02-06 10:56:33,135 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 10:58:06,869 - INFO - Loaded data shape: (838, 1998, 2037)
2025-02-06 10:58:06,870 - INFO - Completed Data Loading in 93.74s
2025-02-06 10:58:06,872 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 10:58:06,872 - INFO - Performing K-means clustering
2025-02-06 10:58:07,789 - INFO - Fitting K-means clustering model...
2025-02-06 11:00:40,472 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:02:17,753 - INFO - Loaded data shape: (838, 1998, 2037)
2025-02-06 11:02:17,753 - INFO - Completed Data Loading in 97.28s
2025-02-06 11:02:17,754 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:02:17,755 - INFO - Performing K-means clustering
2025-02-06 11:02:18,568 - INFO - Fitting K-means clustering model...
2025-02-06 11:04:41,836 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:05:09,857 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 11:05:09,857 - INFO - Completed Data Loading in 28.02s
2025-02-06 11:05:09,858 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:05:09,858 - INFO - Performing K-means clustering
2025-02-06 11:05:09,917 - INFO - Fitting K-means clustering model...
2025-02-06 11:06:08,524 - INFO - Completed K-means Clustering in 58.67s
2025-02-06 11:06:08,524 - INFO - Applying morphological operations
2025-02-06 11:06:08,525 - INFO - Completed Morphological Operations in 0.00s
2025-02-06 11:06:08,525 - ERROR - Pipeline failed: apply_morphological_operations() missing 1 required positional argument: 'kernel_size'
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 104, in main
    binary_mask = apply_morphological_operations(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: apply_morphological_operations() missing 1 required positional argument: 'kernel_size'
2025-02-06 11:09:18,681 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:09:41,084 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 11:09:41,085 - INFO - Completed Data Loading in 22.40s
2025-02-06 11:09:41,086 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:09:41,086 - INFO - Performing K-means clustering
2025-02-06 11:09:41,148 - INFO - Fitting K-means clustering model...
2025-02-06 11:10:29,197 - INFO - Completed K-means Clustering in 48.11s
2025-02-06 11:10:29,197 - INFO - Applying morphological operations
2025-02-06 11:10:31,989 - INFO - Completed Morphological Operations in 2.79s
2025-02-06 11:10:31,989 - ERROR - Pipeline failed: unhashable type: 'ndarray'
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 106, in main
    binary_mask = apply_morphological_operations(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\processing\morphology.py", line 30, in apply_morphological_operations
    if not set(np.unique(mask)).issubset({0, 1}):
           ^^^^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'ndarray'
2025-02-06 11:11:32,151 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:11:55,524 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 11:11:55,524 - INFO - Completed Data Loading in 23.37s
2025-02-06 11:11:55,525 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:11:55,525 - INFO - Performing K-means clustering
2025-02-06 11:11:55,587 - INFO - Fitting K-means clustering model...
2025-02-06 11:12:53,262 - INFO - Completed K-means Clustering in 57.74s
2025-02-06 11:12:53,264 - INFO - Applying morphological operations
2025-02-06 11:12:56,515 - INFO - Completed Morphological Operations in 3.25s
2025-02-06 11:12:56,516 - INFO - Performing watershed segmentation
2025-02-06 11:12:58,601 - INFO - Completed Mask Validation in 2.08s
2025-02-06 11:12:59,249 - INFO - Completed GPU Distance Transform in 0.64s
2025-02-06 11:12:59,359 - INFO - Completed CPU Transfer in 0.11s
2025-02-06 11:13:00,514 - INFO - Completed Peak Detection in 1.15s
2025-02-06 11:13:00,535 - INFO - Completed Marker Creation in 0.02s
2025-02-06 11:13:01,101 - INFO - Completed Watershed in 0.56s
2025-02-06 11:13:01,653 - INFO - Completed GPU Transfer in 0.06s
2025-02-06 11:13:01,671 - INFO - Completed Watershed Segmentation in 5.16s
2025-02-06 11:13:01,671 - INFO - Saving results
2025-02-06 11:13:01,671 - INFO - Completed Saving Results in 0.00s
2025-02-06 11:13:01,672 - ERROR - Pipeline failed: save_tiff_stack() missing 1 required positional argument: 'filename'
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 132, in main
    save_tiff_stack(labels, config.output_path / "segmented_particles.tif")
TypeError: save_tiff_stack() missing 1 required positional argument: 'filename'
2025-02-06 11:17:23,835 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:17:44,623 - INFO - Loaded data shape: (105, 250, 255)
2025-02-06 11:17:44,624 - INFO - Completed Data Loading in 20.79s
2025-02-06 11:17:44,626 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:17:44,626 - INFO - Performing K-means clustering
2025-02-06 11:17:44,632 - INFO - Fitting K-means clustering model...
2025-02-06 11:17:51,523 - INFO - Completed K-means Clustering in 6.90s
2025-02-06 11:17:51,524 - INFO - Applying morphological operations
2025-02-06 11:17:53,350 - INFO - Completed Morphological Operations in 1.83s
2025-02-06 11:17:53,351 - INFO - Performing watershed segmentation
2025-02-06 11:17:53,889 - INFO - Completed Mask Validation in 0.54s
2025-02-06 11:17:53,889 - ERROR - Function 'validate_binary_mask' failed after 0.54s: Binary mask is empty (all zeros)
2025-02-06 11:17:53,890 - ERROR - Watershed segmentation failed: Binary mask is empty (all zeros)
2025-02-06 11:17:53,890 - WARNING - Attempting to fall back to CPU-only processing
2025-02-06 11:17:53,937 - INFO - Completed Mask Validation in 0.05s
2025-02-06 11:17:53,937 - ERROR - Function 'validate_binary_mask' failed after 0.05s: Binary mask is empty (all zeros)
2025-02-06 11:17:53,937 - ERROR - Watershed segmentation failed: Binary mask is empty (all zeros)
2025-02-06 11:17:53,938 - ERROR - Function 'perform_watershed_segmentation' failed after 0.05s: Binary mask is empty (all zeros)
2025-02-06 11:17:53,938 - ERROR - Function 'perform_watershed_segmentation' failed after 0.59s: Binary mask is empty (all zeros)
2025-02-06 11:17:53,938 - INFO - Completed Watershed Segmentation in 0.59s
2025-02-06 11:17:53,938 - ERROR - Pipeline failed: Binary mask is empty (all zeros)
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\processing\watershed.py", line 134, in perform_watershed_segmentation
    validate_binary_mask(binary_mask, timer)
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\utils\timing.py", line 142, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\processing\watershed.py", line 86, in validate_binary_mask
    raise ValueError("Binary mask is empty (all zeros)")
ValueError: Binary mask is empty (all zeros)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 121, in main
    labels = perform_watershed_segmentation(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\utils\timing.py", line 142, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\processing\watershed.py", line 215, in perform_watershed_segmentation
    return perform_watershed_segmentation(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\utils\timing.py", line 142, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\processing\watershed.py", line 134, in perform_watershed_segmentation
    validate_binary_mask(binary_mask, timer)
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\utils\timing.py", line 142, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\processing\watershed.py", line 86, in validate_binary_mask
    raise ValueError("Binary mask is empty (all zeros)")
ValueError: Binary mask is empty (all zeros)
2025-02-06 11:18:40,285 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:19:03,035 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 11:19:03,035 - INFO - Completed Data Loading in 22.75s
2025-02-06 11:19:03,036 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:19:03,036 - INFO - Performing K-means clustering
2025-02-06 11:19:03,097 - INFO - Fitting K-means clustering model...
2025-02-06 11:19:47,946 - INFO - Completed K-means Clustering in 44.91s
2025-02-06 11:19:47,947 - INFO - Applying morphological operations
2025-02-06 11:19:48,233 - INFO - Completed Morphological Operations in 0.29s
2025-02-06 11:19:48,234 - INFO - Performing watershed segmentation
2025-02-06 11:19:50,181 - INFO - Completed Mask Validation in 1.95s
2025-02-06 11:19:50,443 - INFO - Completed GPU Distance Transform in 0.25s
2025-02-06 11:19:50,531 - INFO - Completed CPU Transfer in 0.09s
2025-02-06 11:19:51,584 - INFO - Completed Peak Detection in 1.05s
2025-02-06 11:19:51,604 - INFO - Completed Marker Creation in 0.02s
2025-02-06 11:19:52,121 - INFO - Completed Watershed in 0.52s
2025-02-06 11:19:52,612 - INFO - Completed GPU Transfer in 0.05s
2025-02-06 11:19:52,629 - INFO - Completed Watershed Segmentation in 4.40s
2025-02-06 11:19:52,629 - INFO - Saving results
2025-02-06 11:19:52,796 - INFO - Completed Saving Results in 0.17s
2025-02-06 11:19:52,797 - ERROR - Pipeline failed: plot_orthogonal_views() missing 2 required positional arguments: 'labels' and 'output_path'
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 140, in main
    plot_orthogonal_views(labels, config.output_path / "orthogonal_views.png")
TypeError: plot_orthogonal_views() missing 2 required positional arguments: 'labels' and 'output_path'
2025-02-06 11:20:53,547 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:21:16,794 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 11:21:16,794 - INFO - Completed Data Loading in 23.25s
2025-02-06 11:21:16,795 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:21:16,796 - INFO - Performing K-means clustering
2025-02-06 11:21:16,857 - INFO - Fitting K-means clustering model...
2025-02-06 11:22:04,691 - INFO - Completed K-means Clustering in 47.90s
2025-02-06 11:22:04,692 - INFO - Applying morphological operations
2025-02-06 11:22:05,031 - INFO - Completed Morphological Operations in 0.34s
2025-02-06 11:22:05,032 - INFO - Performing watershed segmentation
2025-02-06 11:22:06,946 - INFO - Completed Mask Validation in 1.91s
2025-02-06 11:22:07,025 - INFO - Completed GPU Distance Transform in 0.07s
2025-02-06 11:22:07,117 - INFO - Completed CPU Transfer in 0.09s
2025-02-06 11:22:08,219 - INFO - Completed Peak Detection in 1.10s
2025-02-06 11:22:08,242 - INFO - Completed Marker Creation in 0.02s
2025-02-06 11:22:08,776 - INFO - Completed Watershed in 0.53s
2025-02-06 11:22:09,278 - INFO - Completed GPU Transfer in 0.05s
2025-02-06 11:22:09,296 - INFO - Completed Watershed Segmentation in 4.26s
2025-02-06 11:22:09,297 - INFO - Saving results
2025-02-06 11:22:14,680 - INFO - Completed Saving Results in 5.38s
2025-02-06 11:22:14,681 - ERROR - Pipeline failed: [Errno 2] No such file or directory: 'output\\orthogonal_views.png\\orthogonal_views.png'
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 140, in main
    plot_orthogonal_views(
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\src\visualization\plotting.py", line 85, in plot_orthogonal_views
    plt.savefig(output_file, dpi=dpi, bbox_inches='tight')
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\.pixi\envs\default\Lib\site-packages\matplotlib\pyplot.py", line 1243, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\.pixi\envs\default\Lib\site-packages\matplotlib\figure.py", line 3490, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\.pixi\envs\default\Lib\site-packages\matplotlib\backends\backend_qtagg.py", line 75, in print_figure
    super().print_figure(*args, **kwargs)
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\.pixi\envs\default\Lib\site-packages\matplotlib\backend_bases.py", line 2184, in print_figure
    result = print_method(
             ^^^^^^^^^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\.pixi\envs\default\Lib\site-packages\matplotlib\backend_bases.py", line 2040, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                 ^^^^^
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\.pixi\envs\default\Lib\site-packages\matplotlib\backends\backend_agg.py", line 481, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\.pixi\envs\default\Lib\site-packages\matplotlib\backends\backend_agg.py", line 430, in _print_pil
    mpl.image.imsave(
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\.pixi\envs\default\Lib\site-packages\matplotlib\image.py", line 1634, in imsave
    image.save(fname, **pil_kwargs)
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\.pixi\envs\default\Lib\site-packages\PIL\Image.py", line 2591, in save
    fp = builtins.open(filename, "w+b")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'output\\orthogonal_views.png\\orthogonal_views.png'
2025-02-06 11:23:49,810 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:24:14,236 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 11:24:14,236 - INFO - Completed Data Loading in 24.43s
2025-02-06 11:24:14,238 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:24:14,238 - INFO - Performing K-means clustering
2025-02-06 11:24:14,299 - INFO - Fitting K-means clustering model...
2025-02-06 11:25:07,752 - INFO - Completed K-means Clustering in 53.51s
2025-02-06 11:25:07,753 - INFO - Applying morphological operations
2025-02-06 11:25:08,120 - INFO - Completed Morphological Operations in 0.37s
2025-02-06 11:25:08,121 - INFO - Performing watershed segmentation
2025-02-06 11:25:10,049 - INFO - Completed Mask Validation in 1.93s
2025-02-06 11:25:10,125 - INFO - Completed GPU Distance Transform in 0.07s
2025-02-06 11:25:10,222 - INFO - Completed CPU Transfer in 0.10s
2025-02-06 11:25:11,294 - INFO - Completed Peak Detection in 1.07s
2025-02-06 11:25:11,315 - INFO - Completed Marker Creation in 0.02s
2025-02-06 11:25:11,872 - INFO - Completed Watershed in 0.56s
2025-02-06 11:25:12,387 - INFO - Completed GPU Transfer in 0.05s
2025-02-06 11:25:12,404 - INFO - Completed Watershed Segmentation in 4.28s
2025-02-06 11:25:12,405 - INFO - Saving results
2025-02-06 11:25:16,975 - INFO - Completed Saving Results in 4.57s
2025-02-06 11:25:16,975 - ERROR - Pipeline failed: 'dict' object has no attribute 'to_csv'
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 156, in main
    stats.to_csv(str(config.output_path / "particle_statistics.csv"))
    ^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'to_csv'
2025-02-06 11:26:43,167 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:27:08,927 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 11:27:08,927 - INFO - Completed Data Loading in 25.76s
2025-02-06 11:27:08,927 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:27:08,929 - INFO - Performing K-means clustering
2025-02-06 11:27:08,990 - INFO - Fitting K-means clustering model...
2025-02-06 11:28:02,315 - INFO - Completed K-means Clustering in 53.39s
2025-02-06 11:28:02,316 - INFO - Applying morphological operations
2025-02-06 11:28:02,620 - INFO - Completed Morphological Operations in 0.30s
2025-02-06 11:28:02,621 - INFO - Performing watershed segmentation
2025-02-06 11:28:04,486 - INFO - Completed Mask Validation in 1.86s
2025-02-06 11:28:04,563 - INFO - Completed GPU Distance Transform in 0.07s
2025-02-06 11:28:04,651 - INFO - Completed CPU Transfer in 0.09s
2025-02-06 11:28:05,664 - INFO - Completed Peak Detection in 1.01s
2025-02-06 11:28:05,685 - INFO - Completed Marker Creation in 0.02s
2025-02-06 11:28:06,197 - INFO - Completed Watershed in 0.51s
2025-02-06 11:28:06,703 - INFO - Completed GPU Transfer in 0.05s
2025-02-06 11:28:06,719 - INFO - Completed Watershed Segmentation in 4.10s
2025-02-06 11:28:06,720 - INFO - Saving results
2025-02-06 11:28:11,224 - INFO - Completed Saving Results in 4.50s
2025-02-06 11:28:11,224 - INFO - Pipeline completed successfully
2025-02-06 11:28:11,224 - ERROR - Pipeline failed: 'Timer' object has no attribute 'summary'
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 182, in main
    logging.info(f"\nPerformance Summary:\n{timer.summary()}")
                                            ^^^^^^^^^^^^^
AttributeError: 'Timer' object has no attribute 'summary'
2025-02-06 11:30:39,044 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:31:10,462 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 11:31:10,463 - INFO - Completed Data Loading in 31.42s
2025-02-06 11:31:10,464 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:31:10,464 - INFO - Performing K-means clustering
2025-02-06 11:31:10,525 - INFO - Fitting K-means clustering model...
2025-02-06 11:32:05,338 - INFO - Completed K-means Clustering in 54.87s
2025-02-06 11:32:05,339 - INFO - Applying morphological operations
2025-02-06 11:32:07,164 - INFO - Completed Morphological Operations in 1.82s
2025-02-06 11:32:07,165 - INFO - Performing watershed segmentation
2025-02-06 11:32:07,165 - INFO - Completed Watershed Segmentation in 0.00s
2025-02-06 11:32:07,165 - ERROR - Pipeline failed: 'NoneType' object is not callable
Traceback (most recent call last):
  File "C:\Users\tmanc\CascadeProjects\ParticleSegmentation\main.py", line 122, in main
    labels = perform_watershed_segmentation(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not callable
2025-02-06 11:33:08,233 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:33:33,574 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 11:33:33,574 - INFO - Completed Data Loading in 25.34s
2025-02-06 11:33:33,575 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:33:33,575 - INFO - Performing K-means clustering
2025-02-06 11:33:33,637 - INFO - Fitting K-means clustering model...
2025-02-06 11:34:31,399 - INFO - Completed K-means Clustering in 57.82s
2025-02-06 11:34:31,400 - INFO - Applying morphological operations
2025-02-06 11:34:31,703 - INFO - Completed Morphological Operations in 0.30s
2025-02-06 11:34:31,704 - INFO - Performing watershed segmentation
2025-02-06 11:37:12,322 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:37:38,021 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 11:37:38,022 - INFO - Completed Data Loading in 25.70s
2025-02-06 11:37:38,022 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:37:38,022 - INFO - Performing K-means clustering
2025-02-06 11:37:38,085 - INFO - Fitting K-means clustering model...
2025-02-06 11:38:37,811 - INFO - Completed K-means Clustering in 59.79s
2025-02-06 11:38:37,812 - INFO - Applying morphological operations
2025-02-06 11:38:38,801 - INFO - Completed Morphological Operations in 0.99s
2025-02-06 11:38:38,801 - INFO - Performing watershed segmentation
2025-02-06 11:43:05,299 - INFO - Completed Mask Validation in 266.50s
2025-02-06 11:43:05,616 - INFO - Completed GPU Distance Transform in 0.31s
2025-02-06 11:43:05,721 - INFO - Completed CPU Transfer in 0.10s
2025-02-06 11:43:34,316 - INFO - Completed Peak Detection in 28.59s
2025-02-06 11:43:34,340 - INFO - Completed Marker Creation in 0.02s
2025-02-06 11:43:39,151 - INFO - Completed Watershed in 4.81s
2025-02-06 11:43:40,075 - INFO - Completed GPU Transfer in 0.10s
2025-02-06 11:43:40,094 - INFO - Completed Watershed Segmentation in 301.29s
2025-02-06 11:43:40,095 - INFO - Saving results
2025-02-06 11:52:14,586 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 11:52:40,622 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 11:52:40,624 - INFO - Completed Data Loading in 26.04s
2025-02-06 11:52:40,624 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 11:52:40,624 - INFO - Performing K-means clustering
2025-02-06 11:52:40,686 - INFO - Fitting K-means clustering model...
2025-02-06 11:53:35,704 - INFO - Completed K-means Clustering in 55.08s
2025-02-06 11:53:35,704 - INFO - Applying morphological operations
2025-02-06 11:53:36,034 - INFO - Completed Morphological Operations in 0.33s
2025-02-06 11:53:36,035 - INFO - Performing watershed segmentation
2025-02-06 11:57:56,119 - INFO - Completed Mask Validation in 260.08s
2025-02-06 11:57:56,477 - INFO - Completed GPU Distance Transform in 0.35s
2025-02-06 11:57:56,571 - INFO - Completed CPU Transfer in 0.09s
2025-02-06 11:58:23,452 - INFO - Completed Peak Detection in 26.88s
2025-02-06 11:58:23,474 - INFO - Completed Marker Creation in 0.02s
2025-02-06 11:58:28,179 - INFO - Completed Watershed in 4.70s
2025-02-06 11:58:29,083 - INFO - Completed GPU Transfer in 0.10s
2025-02-06 11:58:29,103 - INFO - Completed Watershed Segmentation in 293.07s
2025-02-06 11:58:29,103 - INFO - Saving results
2025-02-06 11:58:29,274 - INFO - Generating orthogonal views visualization...
2025-02-06 11:58:29,275 - INFO - Moving raw data to CPU...
2025-02-06 11:58:29,308 - INFO - Moving binary mask to CPU...
2025-02-06 11:58:29,342 - INFO - Moving labels to CPU...
2025-02-06 11:58:29,407 - INFO - Creating figure with 3x3 grid...
2025-02-06 11:58:29,818 - INFO - Plotting XY slices...
2025-02-06 11:58:29,820 - INFO - Plotting XZ slices...
2025-02-06 11:58:29,821 - INFO - Plotting YZ slices...
2025-02-06 11:58:29,825 - INFO - Adjusting layout and saving figure...
2025-02-06 11:58:32,581 - INFO - Saved orthogonal views to output\orthogonal_views.png
2025-02-06 11:58:32,589 - INFO - Starting particle statistics calculation...
2025-02-06 11:58:32,589 - INFO - Moving data to CPU...
2025-02-06 11:58:32,655 - INFO - Finding unique particle labels...
2025-02-06 11:58:33,560 - INFO - Found 65535 particles
2025-02-06 11:58:33,560 - INFO - Calculating particle volumes...
2025-02-06 12:14:09,685 - INFO - Completed Saving Results in 940.58s
2025-02-06 12:14:42,594 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 12:15:06,939 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 12:15:06,939 - INFO - Completed Data Loading in 24.34s
2025-02-06 12:15:06,940 - INFO - Completed GPU Transfer in 0.00s
2025-02-06 12:15:06,940 - INFO - Performing K-means clustering
2025-02-06 12:15:07,002 - INFO - Fitting K-means clustering model...
2025-02-06 12:16:01,846 - INFO - Completed K-means Clustering in 54.91s
2025-02-06 12:16:01,846 - INFO - Applying morphological operations
2025-02-06 12:16:03,851 - INFO - Completed Morphological Operations in 2.00s
2025-02-06 12:16:03,851 - INFO - Performing watershed segmentation
2025-02-06 12:24:16,201 - INFO - Completed Mask Validation in 492.35s
2025-02-06 12:24:16,551 - INFO - Completed GPU Distance Transform in 0.34s
2025-02-06 12:24:16,643 - INFO - Completed CPU Transfer in 0.09s
2025-02-06 12:24:30,124 - INFO - Completed Peak Detection in 13.48s
2025-02-06 12:24:30,145 - INFO - Completed Marker Creation in 0.02s
2025-02-06 12:24:32,767 - INFO - Completed Watershed in 2.62s
2025-02-06 12:24:33,489 - INFO - Completed GPU Transfer in 0.09s
2025-02-06 12:24:33,507 - INFO - Completed Watershed Segmentation in 509.66s
2025-02-06 12:24:33,508 - INFO - Saving results
2025-02-06 12:24:33,699 - INFO - Generating orthogonal views visualization...
2025-02-06 12:24:33,699 - INFO - Moving raw data to CPU...
2025-02-06 12:24:33,732 - INFO - Moving binary mask to CPU...
2025-02-06 12:24:33,766 - INFO - Moving labels to CPU...
2025-02-06 12:24:33,831 - INFO - Creating figure with 3x3 grid...
2025-02-06 12:24:34,189 - INFO - Plotting XY slices...
2025-02-06 12:24:34,192 - INFO - Plotting XZ slices...
2025-02-06 12:24:34,194 - INFO - Plotting YZ slices...
2025-02-06 12:24:34,197 - INFO - Adjusting layout and saving figure...
2025-02-06 12:24:36,851 - INFO - Saved orthogonal views to output\orthogonal_views.png
2025-02-06 12:24:36,858 - INFO - Starting particle statistics calculation...
2025-02-06 12:24:36,859 - INFO - Moving data to CPU...
2025-02-06 12:24:36,924 - INFO - Finding unique particle labels...
2025-02-06 12:24:37,575 - INFO - Found 45359 particles
2025-02-06 12:24:37,575 - INFO - Using parallel volume calculation...
2025-02-06 12:31:24,305 - INFO - Volume calculation completed in 407.45s
2025-02-06 12:31:24,306 - INFO - Calculating equivalent diameters...
2025-02-06 12:31:24,308 - INFO - Computing summary statistics...
2025-02-06 12:31:24,309 - INFO - Statistics summary:
2025-02-06 12:31:24,310 - INFO -   - Particle count: 45359
2025-02-06 12:31:24,310 - INFO -   - Mean diameter: 3.10 µm
2025-02-06 12:31:24,311 - INFO -   - Size range: 1.72 - 9.11 µm
2025-02-06 12:31:24,320 - INFO - Generating size distribution plot...
2025-02-06 12:31:24,334 - INFO - Creating histogram...
2025-02-06 12:31:24,377 - INFO - Adding statistical markers...
2025-02-06 12:31:24,383 - INFO - Saving figure...
2025-02-06 12:31:24,649 - INFO - Saved size distribution plot to output\size_distribution.png
2025-02-06 12:31:24,727 - INFO - Completed Saving Results in 411.22s
2025-02-06 12:31:24,727 - INFO - Pipeline completed successfully
2025-02-06 12:31:24,727 - INFO - 
Performance Summary:
Timing Summary:
------------------------------------------------------------
Stage                          Duration        Percentage     
------------------------------------------------------------
Data Loading                    24.34s           1.0%
GPU Transfer                     0.09s           0.0%
K-means Clustering              54.91s           2.2%
Morphological Operations         2.00s           0.1%
Mask Validation                492.35s          19.6%
GPU Distance Transform           0.34s           0.0%
CPU Transfer                     0.09s           0.0%
Peak Detection                  13.48s           0.5%
Marker Creation                  0.02s           0.0%
Watershed                        2.62s           0.1%
Watershed Segmentation         509.66s          20.3%
Saving Results                 411.22s          16.4%
Total Pipeline                 1002.13s          39.9%
------------------------------------------------------------
Total                          2513.26s

Memory Usage Summary (GB):
--------------------------------------------------------------------------------
Stage                          Peak RSS     Peak VMS     RSS Change   VMS Change  
--------------------------------------------------------------------------------
Total Pipeline                       0.61        1.27        0.44        1.13
Data Loading                         0.34        0.48        0.16        0.34
GPU Transfer                         1.04        1.71        0.02        0.12
K-means Clustering                   0.35        0.54        0.01        0.06
Morphological Operations             0.43        0.95        0.07        0.41
Watershed Segmentation               0.49        1.16        0.07        0.21
Mask Validation                      0.61        0.95        0.19       -0.16
GPU Distance Transform               0.36        2.07        0.00        1.53
CPU Transfer                         0.81        2.07        0.45       -0.49
Peak Detection                       0.82        1.58        0.00       -0.19
Marker Creation                      0.92        1.49        0.10        0.10
Watershed                            1.02        1.59        0.10        0.10
Saving Results                       0.61        1.27        0.12        0.10
2025-02-06 12:37:14,939 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 12:37:37,227 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 12:37:37,229 - INFO - Completed Data Loading in 22.29s
2025-02-06 12:37:37,229 - INFO - Performing K-means clustering
2025-02-06 12:37:37,229 - WARNING - GPU flag is deprecated for K-means, using CPU implementation
2025-02-06 12:37:37,291 - INFO - Fitting K-means with 3 clusters...
2025-02-06 12:38:26,839 - INFO - Created binary mask with 12173251 positive pixels
2025-02-06 12:38:26,868 - INFO - Completed K-means Clustering in 49.64s
2025-02-06 12:38:26,869 - INFO - Applying morphological operations
2025-02-06 12:38:28,067 - INFO - Completed Morphological Operations in 1.20s
2025-02-06 12:38:28,069 - INFO - Performing watershed segmentation
2025-02-06 12:38:28,069 - WARNING - GPU flag is deprecated for watershed, using CPU implementation
2025-02-06 12:46:26,654 - INFO - Completed Mask Validation in 478.58s
2025-02-06 12:46:32,549 - INFO - Completed CPU Distance Transform in 5.89s
2025-02-06 12:46:32,881 - INFO - Completed CPU Transfer in 0.07s
2025-02-06 12:46:48,715 - INFO - Completed Watershed Transform in 15.83s
2025-02-06 12:46:49,359 - INFO - Successfully segmented 45359 particles
2025-02-06 12:46:49,377 - INFO - Completed Watershed Segmentation in 501.31s
2025-02-06 12:46:49,379 - INFO - Saving results
2025-02-06 12:46:49,584 - INFO - Generating orthogonal views visualization...
2025-02-06 12:46:49,584 - INFO - Moving raw data to CPU...
2025-02-06 12:46:49,597 - INFO - Moving labels to CPU...
2025-02-06 12:46:49,648 - INFO - Creating figure with 3x3 grid...
2025-02-06 12:46:50,053 - INFO - Plotting XY slices...
2025-02-06 12:46:50,056 - INFO - Plotting XZ slices...
2025-02-06 12:46:50,058 - INFO - Plotting YZ slices...
2025-02-06 12:46:50,062 - INFO - Adjusting layout and saving figure...
2025-02-06 12:46:52,606 - INFO - Saved orthogonal views to output\orthogonal_views.png
2025-02-06 12:46:52,615 - INFO - Starting particle statistics calculation...
2025-02-06 12:46:52,615 - INFO - Moving data to CPU...
2025-02-06 12:46:52,681 - INFO - Finding unique particle labels...
2025-02-06 12:46:52,889 - INFO - Found 45359 particles
2025-02-06 12:46:52,890 - INFO - Using parallel volume calculation...
2025-02-06 12:48:32,857 - INFO - Completed Saving Results in 103.48s
2025-02-06 12:49:57,450 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 12:50:31,077 - INFO - Loaded data shape: (419, 999, 1018)
2025-02-06 12:50:31,079 - INFO - Completed Data Loading in 33.63s
2025-02-06 12:50:31,079 - INFO - Performing K-means clustering
2025-02-06 12:50:31,079 - WARNING - GPU flag is deprecated for K-means, using CPU implementation
2025-02-06 12:50:31,376 - INFO - Fitting K-means with 3 clusters...
2025-02-06 13:06:55,316 - INFO - Loading data from data\k11-52548_subvolume\subvolumes
2025-02-06 13:07:22,970 - INFO - Loaded data shape: (210, 500, 509)
2025-02-06 13:07:22,970 - INFO - Completed Data Loading in 27.65s
2025-02-06 13:07:22,970 - INFO - Performing K-means clustering...
2025-02-06 13:07:23,031 - INFO - Processing data in 70 chunks using 32 processes...
2025-02-06 13:09:00,532 - WARNING - High variance in cluster centers across chunks. Consider reducing the number of chunks or using different clustering parameters.
2025-02-06 13:09:00,608 - INFO - Created binary mask with 12103300 positive pixels
2025-02-06 13:09:00,626 - INFO - Completed K-means Clustering in 97.66s
2025-02-06 13:09:00,627 - INFO - Applying morphological operations
2025-02-06 13:09:01,582 - INFO - Completed Morphological Operations in 0.96s
2025-02-06 13:09:01,583 - INFO - Performing watershed segmentation
2025-02-06 13:09:01,583 - WARNING - GPU flag is deprecated for watershed, using CPU implementation
2025-02-06 13:20:00,785 - INFO - Completed Mask Validation in 659.20s
2025-02-06 13:20:08,953 - INFO - Completed CPU Distance Transform in 8.16s
2025-02-06 13:20:09,285 - INFO - Completed CPU Transfer in 0.08s
2025-02-06 13:20:29,693 - INFO - Completed Watershed Transform in 20.41s
2025-02-06 13:20:29,883 - INFO - Successfully segmented 45276 particles
2025-02-06 13:20:29,903 - INFO - Completed Watershed Segmentation in 688.32s
2025-02-06 13:20:29,903 - INFO - Saving results
2025-02-06 13:20:30,073 - INFO - Generating orthogonal views visualization...
2025-02-06 13:20:30,074 - INFO - Moving raw data to CPU...
2025-02-06 13:20:30,085 - INFO - Moving labels to CPU...
2025-02-06 13:20:30,134 - INFO - Creating figure with 3x3 grid...
2025-02-06 13:20:30,951 - INFO - Plotting XY slices...
2025-02-06 13:20:30,954 - INFO - Plotting XZ slices...
2025-02-06 13:20:30,954 - INFO - Plotting YZ slices...
2025-02-06 13:20:30,959 - INFO - Adjusting layout and saving figure...
2025-02-06 13:20:34,032 - INFO - Saved orthogonal views to output\orthogonal_views.png
2025-02-06 13:20:34,042 - INFO - Starting particle statistics calculation...
2025-02-06 13:20:34,042 - INFO - Moving data to CPU...
2025-02-06 13:20:34,109 - INFO - Finding unique particle labels...
2025-02-06 13:20:34,419 - INFO - Found 45276 particles
2025-02-06 13:20:34,420 - INFO - Using parallel volume calculation...
2025-02-06 13:29:10,273 - INFO - Volume calculation completed in 516.23s
2025-02-06 13:29:10,274 - INFO - Calculating equivalent diameters...
2025-02-06 13:29:10,276 - INFO - Computing summary statistics...
2025-02-06 13:29:10,277 - INFO - Statistics summary:
2025-02-06 13:29:10,277 - INFO -   - Particle count: 45276
2025-02-06 13:29:10,278 - INFO -   - Mean diameter: 3.10 µm
2025-02-06 13:29:10,279 - INFO -   - Size range: 1.72 - 8.91 µm
2025-02-06 13:29:10,302 - INFO - Generating size distribution plot...
2025-02-06 13:29:10,346 - INFO - Creating histogram...
2025-02-06 13:29:10,386 - INFO - Adding statistical markers...
2025-02-06 13:29:10,399 - INFO - Saving figure...
2025-02-06 13:29:10,795 - INFO - Saved size distribution plot to output\size_distribution.png
2025-02-06 13:29:10,908 - INFO - Completed Saving Results in 521.00s
2025-02-06 13:29:10,909 - INFO - Pipeline completed successfully
2025-02-06 13:29:10,909 - INFO - 
Performance Summary:
Timing Summary:
------------------------------------------------------------
Stage                          Duration        Percentage     
------------------------------------------------------------
Data Loading                    27.65s           0.8%
K-means Clustering              97.66s           2.9%
Morphological Operations         0.96s           0.0%
Mask Validation                659.20s          19.6%
CPU Distance Transform           8.16s           0.2%
CPU Transfer                     0.08s           0.0%
Watershed Transform             20.41s           0.6%
Watershed Segmentation         688.32s          20.5%
Saving Results                 521.00s          15.5%
Total Pipeline                 1335.59s          39.8%
------------------------------------------------------------
Total                          3359.04s

Memory Usage Summary (GB):
--------------------------------------------------------------------------------
Stage                          Peak RSS     Peak VMS     RSS Change   VMS Change  
--------------------------------------------------------------------------------
Total Pipeline                       0.62        2.08        0.44        1.94
Data Loading                         0.34        0.48        0.16        0.34
K-means Clustering                   0.39        0.53        0.05        0.05
Morphological Operations             0.39        0.71        0.00        0.19
Watershed Segmentation               0.65        1.99        0.26        1.27
Mask Validation                      0.59        0.72        0.20        0.01
CPU Distance Transform               0.79        0.92        0.40        0.40
CPU Transfer                         1.29        1.82        0.40        0.40
Watershed Transform                  1.29        1.98       -0.04        0.16
Saving Results                       0.65        2.08       -0.03        0.10
